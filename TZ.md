### Техническое задание на проект: "Steam Friends' Leaderboard"

#### 1. Цель проекта
Создание веб-сервиса для пользователей Steam, который позволяет сравнивать игровую статистику (в первую очередь, время в играх) с друзьями. Сервис анализирует библиотеку игр пользователя и его друзей, после чего формирует "таблицы лидеров" по конкретным играм, помогая ответить на вопрос: "Кто из моих друзей больше всего играет в игру X?".

#### 2. Целевая аудитория и роли пользователей
*   **Целевая аудитория**: Активные пользователи платформы Steam, заинтересованные в соревновательном элементе и сравнении своих игровых достижений (времени, проведенного в играх) с друзьями. Сервис полезен для тех, кто хочет узнать, кто в их компании является самым преданным фанатом конкретной игры.
*   **Роли пользователей**:
    *   **Гость**: Любой посетитель сайта. Может просматривать главную страницу и вводить публичную ссылку на Steam-профиль для проведения анализа.
    *   **Анализируемый пользователь**: Пользователь Steam, чей идентификатор был извлечен из ссылки. Для него система агрегирует данные из API и строит персональные таблицы лидеров по играм. Отдельная регистрация не требуется - доступ к статистике осуществляется по SteamID.

#### 3. Модели данных (сущности)
Проект использует следующие основные модели:

1.  **Users (Пользователь Steam)**
    *   **Назначение**: Хранит основную информацию о пользователе Steam.
    *   **Ключевые поля**: `steamid` (уникальный идентификатор), `personaname` (никнейм), `avatar_url` (ссылка на аватар), `friends` (связь ManyToMany на самого себя для хранения списка друзей).

2.  **Friendship (Дружеская связь)**
    *   **Назначение**: Промежуточная модель для реализации связи "многие ко многим" между пользователями.
    *   **Ключевые поля**: `from_user` (ForeignKey на Users), `to_user` (ForeignKey на Users).

3.  **Game (Игра)**
    *   **Назначение**: Хранит информацию о конкретной игре.
    *   **Ключевые поля**: `appid` (уникальный идентификатор игры), `name` (название), `icon_url` (хеш игры).

4.  **UserGameStats (Игровая статистика пользователя)**
    *   **Назначение**: Связывает пользователя и игру, храня статистику.
    *   **Ключевые поля**: `user` (ForeignKey на Users), `game` (ForeignKey на Game), `playtime_forever` (общее время в игре в часах).

#### 4. Ключевой функционал (User Stories)
*   **Идентификация пользователя**: Гость вставляет ссылку на свой Steam-профиль в форму на главной странице. Система извлекает из ссылки уникальный `steamid`.
*   **Сбор данных**: Система обращается к Steam API, получает данные профиля (имя, аватар), список друзей и список игр с наигранным временем для основного пользователя и каждого из его друзей. Вся информация сохраняется в локальную базу данных.
    *   *Примечание: сбор данных возможен только если анализируемый профиль и профили его друзей являются публичными и не скрывают игровую информацию.*
*   **Отображение профиля**: Пользователь перенаправляется на страницу своего профиля, где видит свою базовую информацию (аватар, ник), список друзей.
*   **Формирование лидерборда**: На странице профиля отображается таблица, где по одной из игр из библиотеки пользователя строится рейтинг. Для первого запроса берётся случайная игра из библиотеки пользователя.В рейтинге участвует сам пользователь и его друзья, отсортированные по времени, проведенному в этой игре.

#### 5. Внешние интеграции / Аналитика
*   **Внешние интеграции**: Проект активно использует **Steam Web API** для получения всей необходимой информации:
    *   `ResolveVanityURL` для получения steamid из кастомной ссылки.
    *   `GetPlayerSummaries` для получения данных профилей.
    *   `GetFriendList` для получения списка друзей.
    *   `GetOwnedGames` для получения списка игр и времени в них.
*   **Аналитика**: Основная аналитическая функция — это агрегация и сортировка данных из модели `UserGameStats` для построения сравнительных таблиц лидеров между друзьями.
